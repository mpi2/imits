<%
  pipeline_array       = TargRep::Pipeline.all.map { |pipeline| [pipeline.name, pipeline.id.to_s] }
  tv_pipeline_options  = options_for_select [['All','']] + pipeline_array, params[:targeting_vectors_pipeline_id_eq]
  esc_pipeline_options = options_for_select [['All','']] + pipeline_array, params[:es_cells_pipeline_id_eq]

  cassette_array = TargRep::Allele.all(:select => 'DISTINCT cassette').map do |allele|
    [allele.cassette, allele.cassette]
  end
  cassette_options = options_for_select [['All','']] + cassette_array, params[:cassette]

  backbone_array = TargRep::Allele.all(:select => 'DISTINCT backbone').map do |allele|
    [allele.backbone, allele.backbone] unless allele.backbone.blank?
  end
  backbone_options = options_for_select [['All','']] + backbone_array, params[:backbone]
%>

<%= form_tag targ_rep_alleles_path, :method => 'get', :id => 'search_form' do %>
  <table class="no-border">
    <tr>
      <td><%= label_tag :gene_marker_symbol, "Marker Symbol" %>:</td>
      <td><%= text_field_tag :gene_marker_symbol_cont, params[:gene_marker_symbol_cont] %></td>
      <td><%= label_tag :gene_mgi_accession_id_eq, "MGI Acc. ID" %>:</td>
      <td><%= text_field_tag :gene_mgi_accession_id_eq, params[:gene_mgi_accession_id_eq] %></td>
      <td><%= label_tag :project_design_id_eq, "Project Design ID" %>:</td>
      <td><%= text_field_tag :project_design_id_eq, params[:project_design_id_eq] %></td>
    </tr>
    <tr>
      <td><%= label_tag :targeting_vectors_pipeline_id_eq, 'TV Pipeline' %>:</td>
      <td><%= select_tag :targeting_vectors_pipeline_id_eq, tv_pipeline_options %></td>
      <td><%= label_tag :es_cells_pipeline_id_eq, 'ESC Pipeline' %>:</td>
      <td><%= select_tag :es_cells_pipeline_id_eq, esc_pipeline_options %></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <td><%= label_tag :mutation_type_id_is, "Mutation Type" %>:</td>
      <td><%= select_tag :mutation_type_id_is, options_for_select([['All','']] + TargRep::MutationType.all.collect{ |u| [u.name, u.id]})  %></td>
      <td><%= label_tag :cassette_is, 'Cassette' %>:</td>
      <td><%= select_tag :cassette_is, cassette_options %></td>
      <td><%= label_tag :backbone_is, 'Backbone' %>:</td>
      <td><%= select_tag :backbone_is, backbone_options %></td>
    </tr>

    <tr>
      <td colspan="4">
        <button type="submit" class="button">
          <%= image_tag "targ_rep/led-icons/find.png", :alt => "" %> Search
        </button>

        <button type="reset" class="button negative">
          <%= image_tag "targ_rep/led-icons/cross.png", :alt => "" %> Reset
        </button>
      </td>
    </tr>
  </table>
<% end %>